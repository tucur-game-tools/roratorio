


CardShortObj =[
	 [
	 	"カードショートカット",
	 	0,
	 	0,
	 	0,
	 	0
	 ],

	 [
	 	"武器カード全解除",
	 	0,
	 	0,
	 	0,
	 	0
	 ],

	 [
	 	"物理　種族20%　2枚",
	 	CARD_ID_PHYSICAL_RACE_ALL_20UP,
	 	CARD_ID_PHYSICAL_RACE_ALL_20UP,
	 	CARD_ID_NONE,
	 	CARD_ID_NONE
	 ],

	 [
	 	"物理　種族20%　3枚",
	 	CARD_ID_PHYSICAL_RACE_ALL_20UP,
	 	CARD_ID_PHYSICAL_RACE_ALL_20UP,
	 	CARD_ID_PHYSICAL_RACE_ALL_20UP,
	 	CARD_ID_NONE
	 ],

	 [
	 	"物理　種族20%　4枚",
	 	CARD_ID_PHYSICAL_RACE_ALL_20UP,
	 	CARD_ID_PHYSICAL_RACE_ALL_20UP,
	 	CARD_ID_PHYSICAL_RACE_ALL_20UP,
	 	CARD_ID_PHYSICAL_RACE_ALL_20UP
	 ],

	 [
	 	"物理　敵属性20%　2枚",
	 	CARD_ID_PHYSICAL_MONSTER_ELM_ALL_20UP,
	 	CARD_ID_PHYSICAL_MONSTER_ELM_ALL_20UP,
	 	CARD_ID_NONE,
	 	CARD_ID_NONE
	 ],

	 [
	 	"物理　敵属性20%　3枚",
	 	CARD_ID_PHYSICAL_MONSTER_ELM_ALL_20UP,
	 	CARD_ID_PHYSICAL_MONSTER_ELM_ALL_20UP,
	 	CARD_ID_PHYSICAL_MONSTER_ELM_ALL_20UP,
	 	CARD_ID_NONE
	 ],

	 [
	 	"物理　敵属性20%　4枚",
	 	CARD_ID_PHYSICAL_MONSTER_ELM_ALL_20UP,
	 	CARD_ID_PHYSICAL_MONSTER_ELM_ALL_20UP,
	 	CARD_ID_PHYSICAL_MONSTER_ELM_ALL_20UP,
	 	CARD_ID_PHYSICAL_MONSTER_ELM_ALL_20UP
	 ],

	 [
	 	"物理　サイズ15%　2枚",
	 	CARD_ID_PHYSICAL_SIZE_ALL_15UP,
	 	CARD_ID_PHYSICAL_SIZE_ALL_15UP,
	 	CARD_ID_NONE,
	 	CARD_ID_NONE
	 ],

	 [
	 	"物理　サイズ15%　3枚",
	 	CARD_ID_PHYSICAL_SIZE_ALL_15UP,
	 	CARD_ID_PHYSICAL_SIZE_ALL_15UP,
	 	CARD_ID_PHYSICAL_SIZE_ALL_15UP,
	 	CARD_ID_NONE
	 ],

	 [
	 	"物理　サイズ15%　4枚",
	 	CARD_ID_PHYSICAL_SIZE_ALL_15UP,
	 	CARD_ID_PHYSICAL_SIZE_ALL_15UP,
	 	CARD_ID_PHYSICAL_SIZE_ALL_15UP,
	 	CARD_ID_PHYSICAL_SIZE_ALL_15UP
	 ],

	 [
	 	"魔法　種族10%　2枚",
	 	CARD_ID_MAGICAL_RACE_ALL_10UP,
	 	CARD_ID_MAGICAL_RACE_ALL_10UP,
	 	CARD_ID_NONE,
	 	CARD_ID_NONE
	 ],

	 [
	 	"魔法　種族10%　3枚",
	 	CARD_ID_MAGICAL_RACE_ALL_10UP,
	 	CARD_ID_MAGICAL_RACE_ALL_10UP,
	 	CARD_ID_MAGICAL_RACE_ALL_10UP,
	 	CARD_ID_NONE
	 ],

	 [
	 	"魔法　種族10%　4枚",
	 	CARD_ID_MAGICAL_RACE_ALL_10UP,
	 	CARD_ID_MAGICAL_RACE_ALL_10UP,
	 	CARD_ID_MAGICAL_RACE_ALL_10UP,
	 	CARD_ID_MAGICAL_RACE_ALL_10UP
	 ],

	 [
	 	"魔法　敵属性10%　2枚",
	 	CARD_ID_MAGICAL_MONSTER_ELM_ALL_10UP,
	 	CARD_ID_MAGICAL_MONSTER_ELM_ALL_10UP,
	 	CARD_ID_NONE,
	 	CARD_ID_NONE
	 ],

	 [
	 	"魔法　敵属性10%　3枚",
	 	CARD_ID_MAGICAL_MONSTER_ELM_ALL_10UP,
	 	CARD_ID_MAGICAL_MONSTER_ELM_ALL_10UP,
	 	CARD_ID_MAGICAL_MONSTER_ELM_ALL_10UP,
	 	CARD_ID_NONE
	 ],

	 [
	 	"魔法　敵属性10%　4枚",
	 	CARD_ID_MAGICAL_MONSTER_ELM_ALL_10UP,
	 	CARD_ID_MAGICAL_MONSTER_ELM_ALL_10UP,
	 	CARD_ID_MAGICAL_MONSTER_ELM_ALL_10UP,
	 	CARD_ID_MAGICAL_MONSTER_ELM_ALL_10UP
	 ],

	 [
	 	"魔法　サイズ8%　2枚",
	 	CARD_ID_MAGICAL_SIZE_ALL_8UP,
	 	CARD_ID_MAGICAL_SIZE_ALL_8UP,
	 	CARD_ID_NONE,
	 	CARD_ID_NONE
	 ],

	 [
	 	"魔法　サイズ8%　3枚",
	 	CARD_ID_MAGICAL_SIZE_ALL_8UP,
	 	CARD_ID_MAGICAL_SIZE_ALL_8UP,
	 	CARD_ID_MAGICAL_SIZE_ALL_8UP,
	 	CARD_ID_NONE
	 ],

	 [
	 	"魔法　サイズ8%　4枚",
	 	CARD_ID_MAGICAL_SIZE_ALL_8UP,
	 	CARD_ID_MAGICAL_SIZE_ALL_8UP,
	 	CARD_ID_MAGICAL_SIZE_ALL_8UP,
	 	CARD_ID_MAGICAL_SIZE_ALL_8UP
	 ],




	 [
	 	"アチャスケ　2枚",
	 	CARD_ID_ARCHER_SKELETON,
	 	CARD_ID_ARCHER_SKELETON,
	 	CARD_ID_NONE,
	 	CARD_ID_NONE
	 ],

	 [
	 	"アチャスケ　3枚",
	 	CARD_ID_ARCHER_SKELETON,
	 	CARD_ID_ARCHER_SKELETON,
	 	CARD_ID_ARCHER_SKELETON,
	 	CARD_ID_NONE
	 ],

	 [
	 	"アチャスケ　4枚",
	 	CARD_ID_ARCHER_SKELETON,
	 	CARD_ID_ARCHER_SKELETON,
	 	CARD_ID_ARCHER_SKELETON,
	 	CARD_ID_ARCHER_SKELETON
	 ],

	 [
	 	"パワフルアチャスケ　2枚",
	 	CARD_ID_POWERFUL_A_SKELETON,
	 	CARD_ID_POWERFUL_A_SKELETON,
	 	CARD_ID_NONE,
	 	CARD_ID_NONE
	 ],

	 [
	 	"パワフルアチャスケ　3枚",
	 	CARD_ID_POWERFUL_A_SKELETON,
	 	CARD_ID_POWERFUL_A_SKELETON,
	 	CARD_ID_POWERFUL_A_SKELETON,
	 	CARD_ID_NONE
	 ],

	 [
	 	"パワフルアチャスケ　4枚",
	 	CARD_ID_POWERFUL_A_SKELETON,
	 	CARD_ID_POWERFUL_A_SKELETON,
	 	CARD_ID_POWERFUL_A_SKELETON,
	 	CARD_ID_POWERFUL_A_SKELETON
	 ],

	 [
	 	"深淵　2枚",
	 	CARD_ID_SHINENNO_KISHI,
	 	CARD_ID_SHINENNO_KISHI,
	 	CARD_ID_NONE,
	 	CARD_ID_NONE
	 ],

	 [
	 	"深淵　3枚",
	 	CARD_ID_SHINENNO_KISHI,
	 	CARD_ID_SHINENNO_KISHI,
	 	CARD_ID_SHINENNO_KISHI,
	 	CARD_ID_NONE
	 ],

	 [
	 	"深淵　4枚",
	 	CARD_ID_SHINENNO_KISHI,
	 	CARD_ID_SHINENNO_KISHI,
	 	CARD_ID_SHINENNO_KISHI,
	 	CARD_ID_SHINENNO_KISHI
	 ],

	 [
	 	"汚染彷徨う者　2枚",
	 	CARD_ID_OSEN_SARETA_SAMAYOU_MONO,
	 	CARD_ID_OSEN_SARETA_SAMAYOU_MONO,
	 	CARD_ID_NONE,
	 	CARD_ID_NONE
	 ],

	 [
	 	"汚染彷徨う者　3枚",
	 	CARD_ID_OSEN_SARETA_SAMAYOU_MONO,
	 	CARD_ID_OSEN_SARETA_SAMAYOU_MONO,
	 	CARD_ID_OSEN_SARETA_SAMAYOU_MONO,
	 	CARD_ID_NONE
	 ],

	 [
	 	"汚染彷徨う者　4枚",
	 	CARD_ID_OSEN_SARETA_SAMAYOU_MONO,
	 	CARD_ID_OSEN_SARETA_SAMAYOU_MONO,
	 	CARD_ID_OSEN_SARETA_SAMAYOU_MONO,
	 	CARD_ID_OSEN_SARETA_SAMAYOU_MONO
	 ],

	 [
	 	"ギガンテス　2枚",
	 	CARD_ID_GIGANTES,
	 	CARD_ID_GIGANTES,
	 	CARD_ID_NONE,
	 	CARD_ID_NONE
	 ],

	 [
	 	"ギガンテス　3枚",
	 	CARD_ID_GIGANTES,
	 	CARD_ID_GIGANTES,
	 	CARD_ID_GIGANTES,
	 	CARD_ID_NONE
	 ],

	 [
	 	"ギガンテス　4枚",
	 	CARD_ID_GIGANTES,
	 	CARD_ID_GIGANTES,
	 	CARD_ID_GIGANTES,
	 	CARD_ID_GIGANTES
	 ],

];





/************************************************************************************************
 *
 * カード選択状態をクリアする（すべて）.
 *
 *-----------------------------------------------------------------------------------------------
 *-----------------------------------------------------------------------------------------------
 * @return なし
 ************************************************************************************************/
function ClearCardSlotAll() {

	// 個別関数を全コール
	ClearCardSlot(EQUIP_REGION_ID_ARMS);
	ClearCardSlot(EQUIP_REGION_ID_ARMS_LEFT);
	ClearCardSlot(EQUIP_REGION_ID_HEAD_TOP);
	ClearCardSlot(EQUIP_REGION_ID_HEAD_MID);
	ClearCardSlot(EQUIP_REGION_ID_HEAD_UNDER);
	ClearCardSlot(EQUIP_REGION_ID_SHIELD);
	ClearCardSlot(EQUIP_REGION_ID_BODY);
	ClearCardSlot(EQUIP_REGION_ID_SHOULDER);
	ClearCardSlot(EQUIP_REGION_ID_SHOES);
	ClearCardSlot(EQUIP_REGION_ID_ACCESSARY_1);
	ClearCardSlot(EQUIP_REGION_ID_ACCESSARY_2);
}

/************************************************************************************************
 *
 * カード選択状態をクリアする.
 *
 *-----------------------------------------------------------------------------------------------
 * @param eqpRgnId 対象となる装備領域ＩＤ
 *-----------------------------------------------------------------------------------------------
 * @return なし
 ************************************************************************************************/
function ClearCardSlot(eqpRgnId) {

	var objidPrifix = "";
	var idxArrayToClear = new Array();

	// サブ関数をコール
	switch (eqpRgnId) {
	case EQUIP_REGION_ID_ARMS:
		objidPrifix = "OBJID_ARMS_RIGHT";
		idxArrayToClear.push(CARD_REGION_ID_ARMS_RIGHT_1);
		idxArrayToClear.push(CARD_REGION_ID_ARMS_RIGHT_2);
		idxArrayToClear.push(CARD_REGION_ID_ARMS_RIGHT_3);
		idxArrayToClear.push(CARD_REGION_ID_ARMS_RIGHT_4);
		break;

	case EQUIP_REGION_ID_ARMS_LEFT:
		objidPrifix = "OBJID_ARMS_LEFT";
		idxArrayToClear.push(CARD_REGION_ID_ARMS_LEFT_1);
		idxArrayToClear.push(CARD_REGION_ID_ARMS_LEFT_2);
		idxArrayToClear.push(CARD_REGION_ID_ARMS_LEFT_3);
		idxArrayToClear.push(CARD_REGION_ID_ARMS_LEFT_4);
		break;

	case EQUIP_REGION_ID_HEAD_TOP:
		objidPrifix = "OBJID_HEAD_TOP";
		idxArrayToClear.push(CARD_REGION_ID_HEAD_TOP);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_HEAD_TOP_1);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_HEAD_TOP_2);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_HEAD_TOP_3);
		break;

	case EQUIP_REGION_ID_HEAD_MID:
		objidPrifix = "OBJID_HEAD_MID";
		idxArrayToClear.push(CARD_REGION_ID_HEAD_MID);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_HEAD_MID_1);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_HEAD_MID_2);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_HEAD_MID_3);
		break;

	case EQUIP_REGION_ID_HEAD_UNDER:
		objidPrifix = "OBJID_HEAD_UNDER";
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_HEAD_UNDER_1);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_HEAD_UNDER_2);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_HEAD_UNDER_3);
		break;

	case EQUIP_REGION_ID_SHIELD:
		objidPrifix = "OBJID_SHIELD";
		idxArrayToClear.push(CARD_REGION_ID_SHIELD);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_SHIELD_1);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_SHIELD_2);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_SHIELD_3);
		break;

	case EQUIP_REGION_ID_BODY:
		objidPrifix = "OBJID_BODY";
		idxArrayToClear.push(CARD_REGION_ID_BODY);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_BODY_1);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_BODY_2);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_BODY_3);
		break;

	case EQUIP_REGION_ID_SHOULDER:
		objidPrifix = "OBJID_SHOULDER";
		idxArrayToClear.push(CARD_REGION_ID_SHOULDER);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_SHOULDER_1);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_SHOULDER_2);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_SHOULDER_3);
		break;

	case EQUIP_REGION_ID_SHOES:
		objidPrifix = "OBJID_SHOES";
		idxArrayToClear.push(CARD_REGION_ID_SHOES);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_SHOES_1);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_SHOES_2);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_SHOES_3);
		break;

	case EQUIP_REGION_ID_ACCESSARY_1:
		objidPrifix = "OBJID_ACCESSARY_1";
		idxArrayToClear.push(CARD_REGION_ID_ACCESSARY_1);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_ACCESSARY_1_1);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_ACCESSARY_1_2);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_ACCESSARY_1_3);
		break;

	case EQUIP_REGION_ID_ACCESSARY_2:
		objidPrifix = "OBJID_ACCESSARY_2";
		idxArrayToClear.push(CARD_REGION_ID_ACCESSARY_2);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_ACCESSARY_2_1);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_ACCESSARY_2_2);
		idxArrayToClear.push(CARD_REGION_ID_ENCHANT_ACCESSARY_2_3);
		break;

	default:
		return;
	}

	__ClearCardSlot(objidPrifix, idxArrayToClear);
}

/************************************************************************************************
 *
 * カード選択状態をクリアする（サブ関数）.
 *
 *-----------------------------------------------------------------------------------------------
 * @param eqpRgnId 対象となる装備領域ＩＤ
 * @param idxArrayToClear 設定をクリアする配列の添字
 *-----------------------------------------------------------------------------------------------
 * @return なし
 ************************************************************************************************/
function __ClearCardSlot(objidPrifix, idxArrayToClear) {

	var idx = 0;
	var strObjId = "";
	var rgnIdx = 0;

	for (idx = SLOT_INDEX_CARD_MIN; idx <= SLOT_INDEX_CARD_MAX; idx++) {
		strObjId = objidPrifix + "_CARD_" + idx;
		HtmlSetObjectValueById(strObjId, CARD_ID_NONE);
		SetStatefullData("DATA_" + strObjId, CARD_ID_NONE);
	}

	for (idx = 0; idx < idxArrayToClear.length; idx++) {
		rgnIdx = idxArrayToClear[idx];
		n_A_card[rgnIdx] = CARD_ID_NONE;
	}
}





/************************************************************************************************
 *
 * カード選択セレクト再構築.
 *
 *-----------------------------------------------------------------------------------------------
 * @param eqpRgnId 装備領域ＩＤ
 * @param itemId 変更後のアイテムＩＤ
 *-----------------------------------------------------------------------------------------------
 ************************************************************************************************/
function RebuildCardSelect(eqpRgnId, itemId) {

	var objidPrifix = "";
	var objSelect = null;
	var idx = 0;
	var objArySlots = new Array();



	// 装備か所ごとに対応するオブジェクトを取得
	switch (eqpRgnId) {

	case EQUIP_REGION_ID_ARMS:
		objidPrifix = "OBJID_ARMS_RIGHT";
		break;

	case EQUIP_REGION_ID_ARMS_LEFT:
		objidPrifix = "OBJID_ARMS_LEFT";
		break;

	case EQUIP_REGION_ID_HEAD_TOP:
		objidPrifix = "OBJID_HEAD_TOP";
		break;

	case EQUIP_REGION_ID_HEAD_MID:
		objidPrifix = "OBJID_HEAD_MID";
		break;

	case EQUIP_REGION_ID_HEAD_UNDER:
		objidPrifix = "OBJID_HEAD_UNDER";
		break;

	case EQUIP_REGION_ID_SHIELD:
		objidPrifix = "OBJID_SHIELD";
		break;

	case EQUIP_REGION_ID_BODY:
		objidPrifix = "OBJID_BODY";
		break;

	case EQUIP_REGION_ID_SHOULDER:
		objidPrifix = "OBJID_SHOULDER";
		break;

	case EQUIP_REGION_ID_SHOES:
		objidPrifix = "OBJID_SHOES";
		break;

	case EQUIP_REGION_ID_ACCESSARY_1:
		objidPrifix = "OBJID_ACCESSARY_1";
		break;

	case EQUIP_REGION_ID_ACCESSARY_2:
		objidPrifix = "OBJID_ACCESSARY_2";
		break;
	}
	objSelect = HtmlGetElementById(objidPrifix);
	for (idx = SLOT_INDEX_CARD_MIN; idx <= SLOT_INDEX_CARD_MAX; idx++) {
		objArySlots.push(HtmlGetElementById(objidPrifix + "_CARD_" + idx));
	}


if (!_ENCH_LIST_MIG) {
	// エンチャントタイプＩＤを取得
	var wpnlv = 0;
	var enchantTypeId = 0;

	if (ItemObjNew[itemId] != undefined) {
		wpnlv = ItemObjNew[itemId][ITEM_DATA_INDEX_WPNLV];
		enchantTypeId = Math.floor(wpnlv / 10) % 10000;
	}
}

	//----------------------------------------------------------------
	// カード欄の再構築
	//----------------------------------------------------------------

	// 項目の全削除
	for (idx = 0; idx < objArySlots.length; idx++) {
		if (objArySlots[idx] == null) {
			continue;
		}

		HtmlRemoveAllChild(objArySlots[idx]);
	}



if (_ENCH_LIST_MIG) {

	// エンチャント情報の収集
	var idx = 0;
	var idxSlot = 0;
	var idxEnchList = 0;

	var enchListId = 0;
	var enchListDataManager = g_constDataManager.GetDataManger(CONST_DATA_KIND_ENCHANT_LIST);
	var enchListIdArray = enchListDataManager.GetEnchListIdArrayByItemId(itemId);

	var enchInfoArrayAllSlots = null;
	var enchInfoArrayAllSlotsResult = null;



	// 結果用配列用意
	enchInfoArrayAllSlotsResult = [];
	for (idxSlot = 0; idxSlot < objArySlots.length; idxSlot++) {
		enchInfoArrayAllSlotsResult[idxSlot] = [];
	}

	// 対象の全エンチャントリストをループ処理
	for (idxEnchList = 0; idxEnchList < enchListIdArray.length; idxEnchList++) {

		// エンチャントリストIDを取得
		enchListId = enchListIdArray[idxEnchList];

		// サブ関数をコールしてデータ配列を収集
		enchInfoArrayAllSlots = RebuildCardSelectSubCollectEnchListData(enchListId, enchInfoArrayAllSlotsResult);

		// 最終結果に追記
		for (idxSlot = 0; idxSlot < enchInfoArrayAllSlots.length; idxSlot++) {
			enchInfoArrayAllSlotsResult[idxSlot] = enchInfoArrayAllSlotsResult[idxSlot].concat(enchInfoArrayAllSlots[idxSlot]);
		}
	}




	// 選択肢の構築
	BuildUpCardSlotsMIG(eqpRgnId, itemId, enchInfoArrayAllSlotsResult, objArySlots);
}


if (!_ENCH_LIST_MIG) {

	// カード項目の追加
	BuildUpCardSlotsCard(eqpRgnId, itemId, enchantTypeId, objArySlots);

	// エンチャント項目の追加
	BuildUpCardSlotsEnchant(enchantTypeId, objArySlots);
}

}

/*
 * エンチャントリストデータを収集する.
 * @param enchListId 収集対象のエンチャントリストID
 * @param enchInfoArrayBefore これまでに、収集されたデータの配列（アップグレードの判定に使用）
 */
function RebuildCardSelectSubCollectEnchListData(enchListId, enchInfoArrayAllSlotsBefore) {

	var idx = 0;
	var idxSlot = 0;
	var idxEnchList = 0;

	var enchListData = null;
	var enchListDataManager = g_constDataManager.GetDataManger(CONST_DATA_KIND_ENCHANT_LIST);

	var enchInfoArray = null;
	var enchInfoArrayAllSlots = null;



	var funcTargetIdCollector = function (enchListIdF, slotF, spDataF, paramsF) {

		var idxF = 0;
		var slotArrayF = null;
		var childrenF = null;
		var cardIdArrayF = null;
		var resultF = null;


		resultF = [];


		switch (spDataF.GetSpId()) {
		case MIG_EQUIPABLE_SP_LIST_DATA_ID_ENCHANT_POSITION_NTH_ENCHANT:
		case MIG_EQUIPABLE_SP_LIST_DATA_ID_ENCHANT_POSITION_NTH_SELECT:
		case MIG_EQUIPABLE_SP_LIST_DATA_ID_ENCHANT_POSITION_NTH_STAGE:
		case MIG_EQUIPABLE_SP_LIST_DATA_ID_ENCHANT_POSITION_NTH_STAGE_V2:

			// 対象スロットの配列を取得
			slotArrayF = spDataF.GetAttribute(MIG_EQUIPABLE_SP_ATTRIBUTE_ID_SLOT);

			if (!Array.isArray(slotArrayF)) {
				return resultF;
			}

			// 指定のスロットが含まれなければ、処理打ち切り
			if (slotArrayF.indexOf(5 - slotF) < 0) {
				return resultF;
			}

			break;

		case MIG_EQUIPABLE_SP_LIST_DATA_ID_ENCHANT_POSITION_NTH_SLOT:
		case MIG_EQUIPABLE_SP_LIST_DATA_ID_ENCHANT_POSITION_NTH_SLOT_V2:
		case MIG_EQUIPABLE_SP_LIST_DATA_ID_ENCHANT_POSITION_NTH_SLOT_V3:
		case MIG_EQUIPABLE_SP_LIST_DATA_ID_ENCHANT_POSITION_NTH_SLOT_V4:

			// 対象スロットの配列を取得
			slotArrayF = spDataF.GetAttribute(MIG_EQUIPABLE_SP_ATTRIBUTE_ID_SLOT);

			if (!Array.isArray(slotArrayF)) {
				return resultF;
			}

			// 指定のスロットが含まれなければ、処理打ち切り
			if (slotArrayF.indexOf(slotF) < 0) {
				return resultF;
			}

			break;

		case MIG_EQUIPABLE_SP_LIST_DATA_ID_REFINE_CONDITION:
		case MIG_EQUIPABLE_SP_LIST_DATA_ID_REFINE_CONDITION_V2:
		case MIG_EQUIPABLE_SP_LIST_DATA_ID_REFINE_CONDITION_V3:
			paramsF = Object.assign({}, paramsF);
			paramsF.refinedBorderBase = spDataF.GetAttribute(MIG_EQUIPABLE_SP_ATTRIBUTE_ID_BORDER_BASE);
			paramsF.refinedBorderFlag = spDataF.GetAttribute(MIG_EQUIPABLE_SP_ATTRIBUTE_ID_BORDER_FLAG);
			break;

		case MIG_EQUIPABLE_SP_LIST_DATA_ID_ENCHANT_EFFECT_LIST:

			// 深淵の回廊アップグレード
			if (enchListIdF == MIG_ENCH_LIST_ID_SHINENNO_KAIRO_UPGRADE) {
				RebuildCardSelectSubCollectEnchListDataSubUpgradeShinennoKairo(enchInfoArrayAllSlotsBefore[slotF - 1], resultF, enchListIdF, paramsF);
			}

			// 思念体武器アップグレード
			else if (enchListIdF == MIG_ENCH_LIST_ID_SHINENTAIBUKI_UPGRADE) {
				RebuildCardSelectSubCollectEnchListDataSubUpgradeShinentaiBuki(enchInfoArrayAllSlotsBefore[slotF - 1], resultF, enchListIdF, paramsF);
			}

			// その他、一般エンチャントの場合
			else {

				// 対象エンチャントの配列を取得して、すべてを追加
				cardIdArrayF = spDataF.GetAttribute(MIG_EQUIPABLE_SP_ATTRIBUTE_ID_CARD);

				for (idxF = 0; idxF < cardIdArrayF.length; idxF++) {
					resultF.push([enchListIdF, cardIdArrayF[idxF], paramsF]);
				}
			}
			break;

		}


		// Collect child data
		childrenF = spDataF.GetChildren();

		if (childrenF) {
			for (idxF = 0; idxF < childrenF.length; idxF++) {
				resultF = resultF.concat(funcTargetIdCollector(enchListIdF, slotF, childrenF[idxF], paramsF));
			}
		}


		return resultF;
	};




	// データ収集用配列用意
	enchInfoArrayAllSlots = [];
	for (idxSlot = 0; idxSlot < (SLOT_INDEX_CARD_MAX - SLOT_INDEX_CARD_MIN + 1); idxSlot++) {
		enchInfoArrayAllSlots[idxSlot] = [];
	}

	// エンチャントリストデータ取得
	enchListData = enchListDataManager.GetDataObject(enchListId);

	// 全SPデータをループ処理
	enchListData.ForEachSpData(
		function (valueF, indexF, arrayF) {

			var idxSlotF = 0;

			// 全スロットをループ処理
			for (idxSlotF = 0; idxSlotF < enchInfoArrayAllSlots.length; idxSlotF++) {
				enchInfoArrayAllSlots[idxSlotF] = enchInfoArrayAllSlots[idxSlotF].concat(funcTargetIdCollector(enchListId, 1 + idxSlotF, valueF, {}));
			}
		}
	);

	// この時点で、当該エンチャントリストのデータは収集が完了している
	// エンチャントの並び順定義に従って、エンチャント効果の順番をソートする
	RebuildCardSelectSubSortCollectedEnchListData(enchInfoArrayAllSlots);



	// 収集したデータを返す
	return enchInfoArrayAllSlots;
}

function RebuildCardSelectSubCollectEnchListDataSubUpgradeShinennoKairo(enchInfoArrayBefore, resultArray, enchListId, paramsObject) {

	var idx = 0;

	var funcPushNotExist = function (cardIdF) {

		for (idxF = 0; idxF < resultArray.length; idxF++) {
			if (resultArray[idxF][1] == cardIdF) {
				return;
			}
		}

		resultArray.push([enchListId, cardIdF, paramsObject]);
	}

	// 処理開始前時点でのエンチャントデータを元に、アップグレード可能なものを特定して追加する
	for (idx = 0; idx < enchInfoArrayBefore.length; idx++) {

		switch (enchInfoArrayBefore[idx][1]) {

		case CARD_ID_ENCHANT_KYOGEKI_4:
			funcPushNotExist(CARD_ID_ENCHANT_KYOGEKI_5);
			break;

		case CARD_ID_ENCHANT_ZOFUKU_4:
			funcPushNotExist(CARD_ID_ENCHANT_ZOFUKU_5);
			break;

		case CARD_ID_ENCHANT_SPECIAL_STR:
			funcPushNotExist(CARD_ID_ENCHANT_TOSHI_10);
			break;

		case CARD_ID_ENCHANT_SPECIAL_AGI:
			funcPushNotExist(CARD_ID_ENCHANT_KOGEKISOKUDO_4);
			break;

		case CARD_ID_ENCHANT_SPECIAL_VIT:
			funcPushNotExist(CARD_ID_ENCHANT_MDEF_10);
			break;

		case CARD_ID_ENCHANT_SPECIAL_INT:
			funcPushNotExist(CARD_ID_ENCHANT_MARYOKU_4);
			break;

		case CARD_ID_ENCHANT_SPECIAL_DEX:
			funcPushNotExist(CARD_ID_ENCHANT_MEIKYU_4);
			break;

		case CARD_ID_ENCHANT_SPECIAL_LUK:
			funcPushNotExist(CARD_ID_ENCHANT_DELAY_DOWN_15);
			break;

		case CARD_ID_ENCHANT_KUMANO_CHIKARA:
			funcPushNotExist(CARD_ID_ENCHANT_HAO);
			break;

		case CARD_ID_ENCHANT_BOSOSHITA_MARYOKU:
			funcPushNotExist(CARD_ID_ENCHANT_SHINRINO_KAIHO);
			break;

		case CARD_ID_ENCHANT_KOSOKU:
			funcPushNotExist(CARD_ID_ENCHANT_SHINO_YOKUDO);
			break;

		case CARD_ID_ENCHANT_OWASHINO_GANKO:
			funcPushNotExist(CARD_ID_ENCHANT_GOKETSU);
			break;

		}
	}
}

function RebuildCardSelectSubCollectEnchListDataSubUpgradeShinentaiBuki(enchInfoArrayBefore, resultArray, enchListId, paramsObject) {

	var idx = 0;

	var funcPushNotExist = function (cardIdF) {

		for (idxF = 0; idxF < resultArray.length; idxF++) {
			if (resultArray[idxF][1] == cardIdF) {
				return;
			}
		}

		resultArray.push([enchListId, cardIdF, paramsObject]);
	}

	// 処理開始前時点でのエンチャントデータを元に、アップグレード可能なものを特定して追加する
	for (idx = 0; idx < enchInfoArrayBefore.length; idx++) {

		switch (enchInfoArrayBefore[idx][1]) {

		case CARD_ID_ENCHANT_ARMS_ELEMENT_FIRE:
		case CARD_ID_ENCHANT_ARMS_ELEMENT_WATER:
		case CARD_ID_ENCHANT_ARMS_ELEMENT_WIND:
		case CARD_ID_ENCHANT_ARMS_ELEMENT_EARTH:
		case CARD_ID_ENCHANT_ARMS_ELEMENT_HOLY:
		case CARD_ID_ENCHANT_ARMS_ELEMENT_DARK:
		case CARD_ID_ENCHANT_ARMS_ELEMENT_PSYCO:
		case CARD_ID_ENCHANT_ARMS_ELEMENT_POISON:
			funcPushNotExist(CARD_ID_ENCHANT_SATSUINO_ONNEN);
			break;

		case CARD_ID_ENCHANT_OWASHINO_GANKO:
			funcPushNotExist(CARD_ID_ENCHANT_GOKETSU);
			break;

		case CARD_ID_ENCHANT_KUMANO_CHIKARA:
			funcPushNotExist(CARD_ID_ENCHANT_HAO);
			break;

		case CARD_ID_ENCHANT_BOSOSHITA_MARYOKU:
			funcPushNotExist(CARD_ID_ENCHANT_SHINRINO_KAIHO);
			break;

		}
	}
}


function RebuildCardSelectSubSortCollectedEnchListData(enchInfoArrayAllSlots) {

	var idx = 0;
	var idxSlot = 0;

	var enchInfoArray = null;


	// 全スロットをループ処理
	for (idxSlot = 0; idxSlot < enchInfoArrayAllSlots.length; idxSlot++) {

		// 当該スロットのエンチャント情報配列を取得
		enchInfoArray = enchInfoArrayAllSlots[idxSlot];

		// エンチャント情報配列を全処理
		for (idx = 0; idx < enchInfoArray.length; idx++) {

			// カードIDを元に、順序を特定
			enchInfoArray[idx][3] = g_constDataManager.enchListDataManager.sortedEnchantCardIdArray.indexOf(enchInfoArray[idx][1]);

			// 該当がない場合は、後ろに設定する
			if (enchInfoArray[idx][3] < 0) {

				// デバッグ時はログ出力
				if (_DEBUG) {
					WriteConsoleLog("エンチャント並び順未定義" + " : " + "cardId == " + EnumCardId.GetDefinedName(enchInfoArray[idx][1]));
				}

				enchInfoArray[idx][3] = g_constDataManager.enchListDataManager.sortedEnchantCardIdArray.length + idx;
			}
		}

		// 特定した並び順でソート
		enchInfoArray.sort(
			function(a, b) {
				if (a[3] < b[3]) return -1;
				if (a[3] > b[3]) return 1;
				return 0;
			}
		);
	}
}





/**
 * カードスロットの再構築（カード項目）.
 */
function BuildUpCardSlotsCard(eqpRgnId, itemId, enchantTypeId, objArySlots) {

	var idx = 0;
	var slotidx = 0;
	var cardSortObjTarget = null;
	var cardIdSelected = 0;
	var cardId = 0;
	var cardName = "";
	var objSelect = null;

	// エンチャントスロット定義を取得
	var enchantSlotData = n_EnchantType[enchantTypeId];


	// スロット配列分ループ
	for (slotidx = 0; slotidx < objArySlots.length; slotidx++) {

		// カード効果がエンチャントされるものを除外
		if ((itemId == ITEM_ID_KAITEI_SHINDENNO_ZAIHO_CARD_ENCHANTABLE) && (slotidx == 3)) {
		}
		else if ((itemId == ITEM_ID_ALPHA_CORE_CARD_ENCHANTABLE) && (slotidx == 3)) {
		}

		// カード効果がエンチャントされるものでなければ、一般的な処理判定を行う
		else {

			// 頭下段は処理しない
			// 武器以外、かつ、スロット２番目以降は処理しない
			switch (eqpRgnId) {
			case EQUIP_REGION_ID_HEAD_UNDER:
				continue;

			case EQUIP_REGION_ID_ARMS:
			case EQUIP_REGION_ID_ARMS_LEFT:
				break;

			default:
				if (slotidx >= 1) {
					continue;
				}
			}

			// 当該スロットがエンチャント用の場合、処理しない
			if (enchantSlotData[slotidx] != 0) {
				continue;
			}
		}



		// 装備箇所に応じたカードデータの追加
		switch (eqpRgnId) {

		case EQUIP_REGION_ID_ARMS:
			if (slotidx == 0) {
				cardSortObjTarget = CardSortOBJ[0];
			}
			else {
				cardSortObjTarget = CardSortOBJ[1];
			}
			cardIdSelected = n_A_card[CARD_REGION_ID_ARMS_RIGHT_1 + slotidx];
			break;

		case EQUIP_REGION_ID_ARMS_LEFT:
			if (slotidx == 0) {
				cardSortObjTarget = CardSortOBJ[0];
			}
			else {
				cardSortObjTarget = CardSortOBJ[1];
			}
			cardIdSelected = n_A_card[CARD_REGION_ID_ARMS_LEFT_1 + slotidx];
			break;

		case EQUIP_REGION_ID_HEAD_TOP:
			cardSortObjTarget = CardSortOBJ[2];
			cardIdSelected = n_A_card[CARD_REGION_ID_HEAD_TOP];
			break;

		case EQUIP_REGION_ID_HEAD_MID:
			cardSortObjTarget = CardSortOBJ[2];
			cardIdSelected = n_A_card[CARD_REGION_ID_HEAD_MID];
			break;

		case EQUIP_REGION_ID_SHIELD:
			cardSortObjTarget = CardSortOBJ[3];
			cardIdSelected = n_A_card[CARD_REGION_ID_SHIELD];
			break;

		case EQUIP_REGION_ID_BODY:
			cardSortObjTarget = CardSortOBJ[4];
			cardIdSelected = n_A_card[CARD_REGION_ID_BODY];
			break;

		case EQUIP_REGION_ID_SHOULDER:
			cardSortObjTarget = CardSortOBJ[5];
			cardIdSelected = n_A_card[CARD_REGION_ID_SHOULDER];
			break;

		case EQUIP_REGION_ID_SHOES:
			cardSortObjTarget = CardSortOBJ[6];
			cardIdSelected = n_A_card[CARD_REGION_ID_SHOES];
			break;

		case EQUIP_REGION_ID_ACCESSARY_1:
			cardSortObjTarget = CardSortOBJ[7];
			cardIdSelected = n_A_card[CARD_REGION_ID_ACCESSARY_1];
			break;

		case EQUIP_REGION_ID_ACCESSARY_2:
			cardSortObjTarget = CardSortOBJ[7];
			cardIdSelected = n_A_card[CARD_REGION_ID_ACCESSARY_2];
			break;

		}

		objSelect = objArySlots[slotidx];
		if (objSelect == null) {
			continue;
		}

		for (idx = 0; idx < cardSortObjTarget.length; idx++) {
			cardId = cardSortObjTarget[idx];
			cardName = GetFlagAppendedCardName(cardId);

			HtmlCreateElementOption(cardId, cardName, objSelect);
		}

		// 選択項目の復元
		objSelect.value = cardIdSelected;
	}
}

/**
 * カードスロットの再構築（エンチャント項目）.
 */
function BuildUpCardSlotsEnchant(enchantTypeId, objArySlots) {

	// エンチャントスロットデータを取得
	var enchantSlotData = n_EnchantType[enchantTypeId];
	var enchantListId = null;

	// エンチャントリスト配列分ループ
	var slotidx = 0;
	var enchantidx = 0;
	var dataId = 0;
	var dataName = "";
	var objSelect = null;
	for (slotidx = 0; slotidx < enchantSlotData.length; slotidx++) {

		// 該当するカード選択オブジェクト配列の要素が null の場合、処理しない
		if (objArySlots.length <= slotidx) {
			break;
		}
		if (objArySlots[slotidx] == null) {
			continue;
		}

		// 構築対象のオブジェクトを取得
		objSelect = objArySlots[slotidx];

		// エンチャントリストＩＤを取得
		enchantListId = enchantSlotData[slotidx];

		// エンチャント選択項目を追加
		for (enchantidx = 0; enchantidx < n_EnchantList[enchantListId].length; enchantidx++) {

			// エンチャントデータＩＤ（実体はカードＩＤ）を取得
			dataId = n_EnchantList[enchantListId][enchantidx];

			// エンチャントの名称を取得
			// length ==0 を入れることで、カード装着部位にエンチャントなしが現れるのを防ぐ
			if (dataId == 0 && objSelect.options.length == 0) {
				dataName = "エンチャントなし";
			}
			else {
				dataName = GetFlagAppendedCardName(dataId);
			}

			// エンチャント項目を選択肢に追加
			HtmlCreateElementOption(dataId, dataName, objSelect);
		}
	}
}

/**
 * カードスロットの再構築（[MIG] カード項目）.
 */
function BuildUpCardSlotsMIG(eqpRgnId, itemId, enchInfoArray, objArySlots) {

	var idx = 0;
	var idxSlot = 0;
	var idxEnchList = 0;
	var idxEnchTarget = 0;

	var enchInfo = null;
	var enchListIdLast = 0;
	var cardSortObjTarget = null;
	var cardIdSelected = 0;
	var cardId = 0;
	var cardName = "";
	var optionData = null;
	var optionDataArray = null;

	var objSelectGroup = null;
	var objSelect = null;

	// XXX: 独自実装
	objDisableItemFlag = document.getElementById("OBJID_DISABLE_OLD_ITEM").checked;

	// スロット配列分ループ
	for (idxSlot = 0; idxSlot < objArySlots.length; idxSlot++) {

		// セレクトボックスのオブジェクトを取得
		objSelect = objArySlots[idxSlot];

		if (!objSelect) {
			continue;
		}

		// 追加済み選択肢データ配列を初期化
		optionDataArray = new Array();

		// 一般エンチャント用のスロットの場合
		if (enchInfoArray[idxSlot].length != 0) {

			// 一部の特例を除いて、エンチャントなしを追加
			if ((itemId == ITEM_ID_RUNE_HELM) && (idxSlot == 3)) {
				// TODO: ミレニアムシールドのオンオフ機能に使っているため。将来的に削除したい。
			}
			else {
				HtmlCreateElementOption(CARD_ID_NONE, "エンチャントなし", objSelect);
			}

			// エンチャント種別を初期化
			enchListIdLast = -1;

			// エンチャントを追加
			for (idxEnchList = 0; idxEnchList < enchInfoArray[idxSlot].length; idxEnchList++) {

				// エンチャント情報を取得
				enchInfo = enchInfoArray[idxSlot][idxEnchList];

				// セレクトボックスのオプショングループを生成
				if (enchListIdLast != enchInfo[0]) {
					objSelectGroup = HtmlCreateElement("optgroup", objSelect);
					objSelectGroup.setAttribute("label", g_constDataManager.GetName(CONST_DATA_KIND_ENCHANT_LIST, enchInfo[0]));
					objSelectGroup.setAttribute("data-ench-list-id", enchInfo[0]);

					enchListIdLast = enchInfo[0];
				}

				// エンチャントデータ（カードデータ）を特定
				cardId = enchInfo[1];
				cardName = CardObjNew[cardId][CARD_DATA_INDEX_NAME];

				// 選択肢として、既に追加されていないか検査
				optionData = enchListIdLast + "-" + cardId;
				if (optionDataArray.indexOf(optionData) >= 0) {
					continue;
				}
				optionDataArray.push(optionData);

				// 精錬条件を追記
				if (enchInfo[2].refinedBorderBase) {
					if (enchInfo[2].refinedBorderFlag) {
						if (!((enchInfo[2].refinedBorderBase == 0) && (enchInfo[2].refinedBorderFlag == MIG_BORDER_FLAG_ID_OVER))) {
							cardName += " (+" + enchInfo[2].refinedBorderBase + MigGetBorderFlagText(enchInfo[2].refinedBorderFlag, true) + ")";
						}
					}
				}

				// 選択肢を追加
				HtmlCreateElementOption(cardId, cardName, objSelectGroup);
			}

			// カード用の処理はしない
			continue;
		}

		// カード効果がエンチャントされるものを除外
		else if ((itemId == ITEM_ID_KAITEI_SHINDENNO_ZAIHO_CARD_ENCHANTABLE) && (idxSlot == 3)) {
		}
		else if ((itemId == ITEM_ID_ALPHA_CORE_CARD_ENCHANTABLE) && (idxSlot == 3)) {
		}

		// カード用のスロットの場合
		else {

			// 頭下段は処理しない
			// 武器以外、かつ、スロット２番目以降は、ダミー要素を追加して、次へ
			switch (eqpRgnId) {
			case EQUIP_REGION_ID_HEAD_UNDER:
				HtmlCreateElementOption(CARD_ID_NONE, "-", objSelect);
				continue;

			case EQUIP_REGION_ID_ARMS:
			case EQUIP_REGION_ID_ARMS_LEFT:
				break;

			default:
				if (idxSlot >= 1) {
					HtmlCreateElementOption(CARD_ID_NONE, "-", objSelect);
					continue;
				}
			}
		}



		// 装備箇所に応じたカードデータの追加
		switch (eqpRgnId) {

		case EQUIP_REGION_ID_ARMS:
			if (idxSlot == 0) {
				cardSortObjTarget = CardSortOBJ[0];
			}
			else {
				cardSortObjTarget = CardSortOBJ[1];
			}
			cardIdSelected = n_A_card[CARD_REGION_ID_ARMS_RIGHT_1 + idxSlot];
			break;

		case EQUIP_REGION_ID_ARMS_LEFT:
			if (idxSlot == 0) {
				cardSortObjTarget = CardSortOBJ[0];
			}
			else {
				cardSortObjTarget = CardSortOBJ[1];
			}
			cardIdSelected = n_A_card[CARD_REGION_ID_ARMS_LEFT_1 + idxSlot];
			break;

		case EQUIP_REGION_ID_HEAD_TOP:
			cardSortObjTarget = CardSortOBJ[2];
			cardIdSelected = n_A_card[CARD_REGION_ID_HEAD_TOP];
			break;

		case EQUIP_REGION_ID_HEAD_MID:
			cardSortObjTarget = CardSortOBJ[2];
			cardIdSelected = n_A_card[CARD_REGION_ID_HEAD_MID];
			break;

		case EQUIP_REGION_ID_SHIELD:
			cardSortObjTarget = CardSortOBJ[3];
			cardIdSelected = n_A_card[CARD_REGION_ID_SHIELD];
			break;

		case EQUIP_REGION_ID_BODY:
			cardSortObjTarget = CardSortOBJ[4];
			cardIdSelected = n_A_card[CARD_REGION_ID_BODY];
			break;

		case EQUIP_REGION_ID_SHOULDER:
			cardSortObjTarget = CardSortOBJ[5];
			cardIdSelected = n_A_card[CARD_REGION_ID_SHOULDER];
			break;

		case EQUIP_REGION_ID_SHOES:
			cardSortObjTarget = CardSortOBJ[6];
			cardIdSelected = n_A_card[CARD_REGION_ID_SHOES];
			break;

		case EQUIP_REGION_ID_ACCESSARY_1:
			cardSortObjTarget = CardSortOBJ[7];
			cardIdSelected = n_A_card[CARD_REGION_ID_ACCESSARY_1];
			break;

		case EQUIP_REGION_ID_ACCESSARY_2:
			cardSortObjTarget = CardSortOBJ[7];
			cardIdSelected = n_A_card[CARD_REGION_ID_ACCESSARY_2];
			break;

		}

		for (idx = 0; idx < cardSortObjTarget.length; idx++) {
			cardId = cardSortObjTarget[idx];
			cardName = GetFlagAppendedCardName(cardId);

			// XXX: 独自実装 {
			cardExpData = CardExpObj[cardId];
			if (objDisableItemFlag && cardExpData[ITEM_EXP_INDEX_DISABLE_FLAG]) continue;
			// }

			HtmlCreateElementOption(cardId, cardName, objSelect);
		}

		// 選択項目の復元
		objSelect.value = cardIdSelected;
	}
}

/**
 * カードスロットの使用可否を設定する.
 */
function SetCardSlotEnabilityAll() {

	// 個別関数を全コール
	SetCardSlotEnability(EQUIP_REGION_ID_ARMS);
	SetCardSlotEnability(EQUIP_REGION_ID_ARMS_LEFT);
	SetCardSlotEnability(EQUIP_REGION_ID_HEAD_TOP);
	SetCardSlotEnability(EQUIP_REGION_ID_HEAD_MID);
	SetCardSlotEnability(EQUIP_REGION_ID_HEAD_UNDER);
	SetCardSlotEnability(EQUIP_REGION_ID_SHIELD);
	SetCardSlotEnability(EQUIP_REGION_ID_BODY);
	SetCardSlotEnability(EQUIP_REGION_ID_SHOULDER);
	SetCardSlotEnability(EQUIP_REGION_ID_SHOES);
	SetCardSlotEnability(EQUIP_REGION_ID_ACCESSARY_1);
	SetCardSlotEnability(EQUIP_REGION_ID_ACCESSARY_2);
}

function SetCardSlotEnability(eqpRgnId) {

	var strObjIdPrifix = "";

	var idx = 0;
	var strObjId = "";
	var objSelect = null;
	var usable = false;

	// サブ関数をコール
	switch (eqpRgnId) {
	case EQUIP_REGION_ID_ARMS:
		strObjIdPrifix = "OBJID_ARMS_RIGHT";
		break;

	case EQUIP_REGION_ID_ARMS_LEFT:
		strObjIdPrifix = "OBJID_ARMS_LEFT";
		break;

	case EQUIP_REGION_ID_HEAD_TOP:
		strObjIdPrifix = "OBJID_HEAD_TOP";
		break;

	case EQUIP_REGION_ID_HEAD_MID:
		strObjIdPrifix = "OBJID_HEAD_MID";
		break;

	case EQUIP_REGION_ID_HEAD_UNDER:
		strObjIdPrifix = "OBJID_HEAD_UNDER";
		break;

	case EQUIP_REGION_ID_SHIELD:
		strObjIdPrifix = "OBJID_SHIELD";
		break;

	case EQUIP_REGION_ID_BODY:
		strObjIdPrifix = "OBJID_BODY";
		break;

	case EQUIP_REGION_ID_SHOULDER:
		strObjIdPrifix = "OBJID_SHOULDER";
		break;

	case EQUIP_REGION_ID_SHOES:
		strObjIdPrifix = "OBJID_SHOES";
		break;

	case EQUIP_REGION_ID_ACCESSARY_1:
		strObjIdPrifix = "OBJID_ACCESSARY_1";
		break;

	case EQUIP_REGION_ID_ACCESSARY_2:
		strObjIdPrifix = "OBJID_ACCESSARY_2";
		break;
	}


	// 当該プリフィックスを持つ全要素に対して実行
	for (idx = SLOT_INDEX_CARD_MIN; idx <= SLOT_INDEX_CARD_MAX; idx++) {

		// 対象オブジェクトを特定
		strObjId = strObjIdPrifix + "_CARD_" + idx;
		objSelect = HtmlGetElementById(strObjId);

		// 選択項目がひとつ（カードなし／エンチャントなし）しかない場合、操作不可にする
		usable = objSelect.options.length > 1;

		// 強制条件
		// 左手は二刀流の場合のみ利用可能
		if (eqpRgnId == EQUIP_REGION_ID_ARMS_LEFT) {
			usable = ((usable) & (n_Nitou));
		}
		// 盾は二刀流の場合、利用不可
		if (eqpRgnId == EQUIP_REGION_ID_SHIELD) {
			usable = ((usable) & (!n_Nitou));
		}

		// サブ関数をコール
		__SetCardSlotEnability(objSelect, usable);
	}


}

function __SetCardSlotEnability(objTarget, enabled) {

	if (objTarget == null) {
		return;
	}

	// 使用可否設定
	objTarget.disabled = !enabled;

	// 可視設定
	if (enabled) {
		objTarget.style.visibility = "visible";
	} else {
		objTarget.style.visibility = "hidden";
	}
}





/************************************************************************************************
 *
 * カードのショートカットを適用する.
 *
 *-----------------------------------------------------------------------------------------------
 * @param eqpRgnId 対象となる装備領域ＩＤ
 * @param objidPrifix オブジェクトＩＤのプリフィックス
 *-----------------------------------------------------------------------------------------------
 * @return なし
 ************************************************************************************************/
function ApplyCardShort(eqpRgnId, objidPrifix) {

	var idx = 0;
	var idxOption = 0;

	var cardSCIdx = 0;
	var cardIdToSet = 0;

	var itemId = 0;
	var itemData = null;

	var slotCountMax = 0;
	var slotCountLooped = 0;

	var objSelect = null;
	var objOption = null;



	// 変更後のカードショートカットのインデックスを取得
	cardSCIdx = HtmlGetObjectValueById(objidPrifix + "_CARD_SHORT", 0);

	// 当該装備の情報を取得
	itemId = n_A_Equip[eqpRgnId];
	itemData = ItemObjNew[itemId];

	// 最大スロット数を取得
	slotCountMax = GetMaxSlot(itemData[ITEM_DATA_INDEX_SLOT]);

	// カードスロット数分ループ
	slotCountLooped = 0;
	for (idx = SLOT_INDEX_CARD_MIN; idx <= SLOT_INDEX_CARD_MAX; idx++) {

		// TODO: 不要な気がしたので実装先送り
		// 装備のスロット数を越えたら処理終了
		// if (slotCountMax < ++slotCountLooped) {
		// 	break;
		// }

		// 設定対象のセレクトボックスを特定
		objSelect = document.getElementById(objidPrifix + "_CARD_" + idx);
		if (!objSelect) {
			continue;
		}

		// 設定するＩＤを取得
		cardIdToSet = CardShortObj[cardSCIdx][idx];

		// 選択可能であることを確認してからセットする
		for (idxOption = 0; idxOption < objSelect.options.length; idxOption++) {

			objOption = objSelect.options[idxOption];

			if (objOption.value == cardIdToSet) {

				// ショートカットデータから、カードを引き当て
				HtmlSetObjectValueById(objidPrifix + "_CARD_" + idx, cardIdToSet);

				// ステートフルデータを更新
				SetStatefullData("DATA_" + objidPrifix + "_CARD_" + idx, cardIdToSet);

				break;
			}
		}
	}

	// ステータス再計算
	StAllCalc();

	// 攻撃手段の更新
	CAttackMethodAreaComponentManager.RebuildControls();
}
